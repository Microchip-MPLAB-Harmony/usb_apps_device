<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>HID Basic Remote Wakeup Example | Harmony 3 USB Device application examples</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="HID Basic Remote Wakeup Example" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 USB Device application examples" /> <meta property="og:description" content="Harmony 3 USB Device application examples" /> <link rel="canonical" href="../../apps/hid_basic_remote_wakeup/readme.html" /> <meta property="og:url" content="../../apps/hid_basic_remote_wakeup/readme.html" /> <meta property="og:site_name" content="Harmony 3 USB Device application examples" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="HID Basic Remote Wakeup Example" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Harmony 3 USB Device application examples","headline":"HID Basic Remote Wakeup Example","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"url":"../../apps/hid_basic_remote_wakeup/readme.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../index.html" class="nav-list-link">Harmony 3 USB Device application examples</a><ul class="nav-list "><li class="nav-list-item "><a href="../../apps/cdc_com_port_dual/readme.html" class="nav-list-link">CDC COM Port Dual Example</a></li><li class="nav-list-item "><a href="../../apps/cdc_com_port_single/readme.html" class="nav-list-link">CDC COM Port Single Example</a></li><li class="nav-list-item "><a href="../../apps/cdc_msd_basic/readme.html" class="nav-list-link">CDC MSD Basic Example</a></li><li class="nav-list-item "><a href="../../apps/cdc_msd_sdcard/readme.html" class="nav-list-link">CDC MSD SD Card Example</a></li><li class="nav-list-item "><a href="../../apps/cdc_serial_emulator/readme.html" class="nav-list-link">CDC Serial Emulator Example</a></li><li class="nav-list-item "><a href="../../apps/cdc_serial_emulator_msd/readme.html" class="nav-list-link">CDC Serial Emulator MSD Example</a></li><li class="nav-list-item "><a href="../../apps/hid_basic/readme.html" class="nav-list-link">HID Basic Example</a></li><li class="nav-list-item active"><a href="../../apps/hid_basic_remote_wakeup/readme.html" class="nav-list-link active">HID Basic Remote Wakeup Example</a></li><li class="nav-list-item "><a href="../../apps/hid_joystick/readme.html" class="nav-list-link">HID Joystick Example</a></li><li class="nav-list-item "><a href="../../apps/hid_keyboard/readme.html" class="nav-list-link">HID Keyboard Example</a></li><li class="nav-list-item "><a href="../../apps/hid_msd_basic/readme.html" class="nav-list-link">HID MSD Basic Example</a></li><li class="nav-list-item "><a href="../../apps/hid_mouse/readme.html" class="nav-list-link">HID Mouse Example</a></li><li class="nav-list-item "><a href="../../apps/msd_basic/readme.html" class="nav-list-link">MSD Basic Example</a></li><li class="nav-list-item "><a href="../../apps/msd_multiple_luns/readme.html" class="nav-list-link">MSD Multiple LUN Example</a></li><li class="nav-list-item "><a href="../../apps/msd_sdcard/readme.html" class="nav-list-link">MSD SD Card Example</a></li><li class="nav-list-item "><a href="../../apps/printer_basic/readme.html" class="nav-list-link">Printer Example</a></li><li class="nav-list-item "><a href="../../apps/usb_uart_bridge_dual/readme.html" class="nav-list-link">USB UART Bridge Dual Channel Example</a></li><li class="nav-list-item "><a href="../../apps/usb_uart_bridge_single/readme.html" class="nav-list-link">USB UART Bridge Single Channel Example</a></li><li class="nav-list-item "><a href="../../apps/vendor/readme.html" class="nav-list-link">Vendor Example</a></li></ul></li><li class="nav-list-item"><a href="../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Harmony 3 USB Device application examples" aria-label="Search Harmony 3 USB Device application examples" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../index.html">Harmony 3 USB Device application examples</a></li> <li class="breadcrumb-nav-list-item"><span>HID Basic Remote Wakeup Example</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><a href="https://www.microchip.com"><img src="https://www.microchip.com/ResourcePackages/Microchip/assets/dist/images/logo.png" alt="MCHP" /></a></p> <h1 id="hid-basic-remote-wakeup-example-hid_basic_remote_wakeup"> <a href="#hid-basic-remote-wakeup-example-hid_basic_remote_wakeup" aria-labelledby="hid-basic-remote-wakeup-example-hid_basic_remote_wakeup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HID Basic Remote Wakeup Example (hid_basic_remote_wakeup) </h1> <p>This application demonstrates the ability of the MPLAB® Harmony USB Device Stack to support the Remote Wakeup feature using a custom HID device class example.</p> <h2 id="description"> <a href="#description" aria-labelledby="description" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p>This application creates a USB HID Device that enumerates as a custom USB HID device on the USB host PC. The device allows the USB Host utility to control the LEDs on the board and query the status of a switch. This example demonstrates suspend/resume initiated by PC host and Remote Wakeup initiated by HID Device using a PC-based utility. The application will put the device to Standby sleep mode when it receives a suspend from PC host. The Push-button is used as wakeup source when the device goes to Standby sleep mode.</p> <h2 id="downloading-and-building-the-application"> <a href="#downloading-and-building-the-application" aria-labelledby="downloading-and-building-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading and building the application </h2> <p>To clone or download this application from Github, go to the <a href="https://github.com/Microchip-MPLAB-Harmony/usb_apps_device">main page of this repository</a> and then click <strong>Clone</strong> button to clone this repository or download as zip file. This content can also be downloaded using the MPLAB® Harmony Content Manager by following these <a href="https://github.com/Microchip-MPLAB-Harmony/contentmanager/wiki">instructions</a>.</p> <p>Path of the application within the repository is <a href="https://github.com/Microchip-MPLAB-Harmony/usb_apps_device/tree/master/apps/hid_basic_remote_wakeup">usb_apps_device/apps/hid_basic_remote_wakeup</a>.</p> <p>Following table gives the details of project configurations, target device used, hardware and its IDE. Open the project using the respective IDE and build it.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>IDE</th> <th>Target Device</th> <th>Hardware / Configuration</th> </tr> </thead> <tbody> <tr> <td>sam_e54_xpro.X</td> <td>MPLABX</td> <td>ATSAME54P20A</td> <td><a href="#config_3">SAM E54 Xplained Pro Board</a></td> </tr> <tr> <td>sam_l21_xpro.X</td> <td>MPLABX</td> <td>ATSAML21J18B</td> <td><a href="#config_7">SAML21 Xplained Pro Board</a></td> </tr> </tbody> </table></div> <h2 id="-configuring-the-hardware"> <a href="#-configuring-the-hardware" aria-labelledby="-configuring-the-hardware" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a name="config_title"></a> Configuring the Hardware </h2> <h3 id="-same54-xplained-pro-board"> <a href="#-same54-xplained-pro-board" aria-labelledby="-same54-xplained-pro-board" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a name="config_3"></a> <a href="https://www.microchip.com/developmenttools/productdetails/atsame54-xpro">SAME54 Xplained Pro Board</a> </h3> <ul> <li>Use TARGET USB connector on the board to connect the USB Device to the USB Host PC.</li> <li>LED0 indicates USB Device Configuration Set Complete event (the USB device functionality has been activated by the USB Host).</li> <li>Press the switch SW0 to trigger communication from the USB Device to the USB Host.</li> <li>When the device is in Standby sleep, SW0 acts as wakeup source and brings the device to active mode. The device sends Remote wakeup to PC host and then goes back to Standby sleep mode to let the PC host drive the resume.</li> <li>To measure current consumed by the device in different Sleep modes, refer to Section <strong>Current Measurement Header</strong> in <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/70005321A.pdf">SAME54 Xplained Pro Hardware User Guide</a>. Refer to <strong>Virtual COM Port</strong> section to know more on using EDBG to send runtime messages.</li> </ul> <h3 id="-saml21-xplained-pro-board"> <a href="#-saml21-xplained-pro-board" aria-labelledby="-saml21-xplained-pro-board" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a name="config_7"></a> <a href="https://www.microchip.com/developmenttools/ProductDetails/PartNO/ATSAML21-XPRO-B">SAML21 Xplained Pro Board</a> </h3> <ul> <li>Use TARGET USB connector on the board to connect the USB Device to the USB Host PC.</li> <li>LED0 indicates USB Device Configuration Set Complete event (the USB device functionality has been activated by the USB Host).</li> <li>Press the switch SW0 to trigger communication from the USB Device to the USB Host.</li> <li>When the device is in Standby sleep, SW0 acts as wakeup source and brings the device to active mode. The device sends Remote wakeup to PC host and then goes back to Standby sleep mode to let the PC host drive the resume.</li> </ul> <h2 id="running-the-application"> <a href="#running-the-application" aria-labelledby="running-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running the Application </h2> <h3 id="application-state-messages-using-edbg"> <a href="#application-state-messages-using-edbg" aria-labelledby="application-state-messages-using-edbg" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Application State Messages using EDBG </h3> <p>Runtime messages are sent through UART, which is received by EDBG and sent to PC terminal as USB CDC data. Follow the below steps to see the runtime messages.</p> <ol> <li>When the debug USB port is connected to the PC, it should be visible as a virtual COM port.</li> <li>Open up a terminal program, such as HyperTerminal and select the appropriate COM port. Set the serial port settings as follows: <ul> <li>Baud : 115200</li> <li>Data : 8 Bits</li> <li>Parity : None</li> <li>Stop : 1 Bit</li> <li>Flow Control : None</li> </ul> <p><img src="../../apps/hid_basic_remote_wakeup/images/hid_basic_remote_wakeup_1.png" alt="COM port settings" /></p> </li> <li>When the programming is complete and the application starts running, the title message will be seen.</li> <li> <p>Connect the Upstream USB port to the PC and when the enumeration is successful, <strong><em>Device Configured</em></strong> message is seen. Since this is a HID device, PC host will suspend the device, unless an application is accessing it. The terminal window would now look like this.</p> <p><img src="../../apps/hid_basic_remote_wakeup/images/hid_basic_remote_wakeup_2.png" alt="Starting Message" /></p> </li> </ol> <h3 id="hid-basic-operation"> <a href="#hid-basic-operation" aria-labelledby="hid-basic-operation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HID Basic operation </h3> <p>The HID Basic operation is same as <em>hid_basic</em> demo. Refer to local documentation from <a href="../../apps/hid_basic/readme.html">usb_apps_device/apps/hid_basic</a>. The documentation is also available in the github path <a href="https://github.com/Microchip-MPLAB-Harmony/usb_apps_device/apps/hid_basic">usb_apps_device/apps/hid_basic</a>.</p> <h3 id="remote-wakeup-suspend-and-resume-operation"> <a href="#remote-wakeup-suspend-and-resume-operation" aria-labelledby="remote-wakeup-suspend-and-resume-operation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Remote Wakeup, Suspend and Resume operation </h3> <ol> <li> <p>To demonstrate the Remote wakeup capabilities along with the debug messages, the Upstream ports of target USB and debug USB should be connected to two different PC Hosts. This is shown below.</p> <p><img src="../../apps/hid_basic_remote_wakeup/images/hid_basic_remote_wakeup_3.png" alt="COM port settings" /></p> </li> <li>When the PC utility is connected to the USB device, <strong><em>USB Device Resumed</em></strong> message is seen. Closing the application would <em>suspend</em> the USB device and the respective message will be seen.</li> <li>The suspend due to closure of PC utility will not enable the Remote Wakeup of USB device. Hence the message <strong><em>USB host Suspend device or Remote wakeup is not enabled</em></strong> would be seen. The device will be put to Standby Sleep mode.</li> <li>A resume from PC host can wake up the device and continue with HID operation. This is when <strong><em>USB Device Resumed</em></strong> message is shown.</li> <li>Put the PC host connected to Target USB port to sleep to test Remote wakeup. If the device is allowed to wake up PC host, then the Remote Wakeup will be enabled in the USB device by PC host before suspending the bus. This is shown through <strong><em>USB host in Sleep mode - Remote wakeup enabled. Press Button to wakeup Host.</em></strong> message.</li> <li>If the message <strong><em>USB host Suspend device or Remote wakeup is not enabled</em></strong> is seen when PC host is put to sleep, it means the USB device is not allowed to do Remote Wakeup. Go to the power settings of the USB device in PC host and enable Remote wakeup feature. This can be done in a Windows machine through device manager or command prompt. Below are the commands and their usage. <ul> <li><strong>powercfg -devicequery wake_from_any</strong> - Displays all devices that are connected to the PC.</li> <li><strong>powercfg -devicequery wake_armed</strong> - Devices that can wake up PC from its sleep state.</li> <li><strong>powercfg -deviceenablewake</strong> - To enable Remote wakeup privilege for any of the connected Devices <ul> <li>eg:- powercfg -deviceenablewake “HID-compliant vendor-defined device (002)”</li> </ul> </li> <li><strong>powercfg -devicedisablewake</strong> - To disable Remote wakeup privilege for any of the connected Devices.</li> </ul> </li> <li> <p>If the Remote Wakeup is enabled and the device is put to sleep, press the switch to initiate a <strong>Remote Wakeup</strong>. The PC host will respond back with a resume and device will continue with its HID operation. The screenshot showing suspend, resume and remote wakeup operations are shown below.</p> <p><img src="../../apps/hid_basic_remote_wakeup/images/hid_basic_remote_wakeup_4.png" alt="COM port settings" /></p> </li> </ol> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2022 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
